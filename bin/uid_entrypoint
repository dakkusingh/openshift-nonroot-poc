#!/bin/bash
# See https://github.com/GrahamDumpleton/docker-solr/commit/a0592c58947ff2f0c5975099dc3ff9058fe91ef6

# add entry to passwd file to match what OpenShift is being run as
if [ $(id -u) != 0 -a $(id -u) != $WODBY_UID ]; then
    cat /etc/passwd | sed -e "s/^.*:x:$WODBY_UID:0:/$WODBY_USER-build:x:$WODBY_UID:0:/" > /tmp/passwd
    echo "$WODBY_USER:x:$(id -u):0:$WODBY_USER,,,:$HOME:/bin/bash" >> /tmp/passwd
    cat /tmp/passwd > /etc/passwd
    rm /tmp/passwd
fi

# execute command passed in as arguments.
exec "$@"